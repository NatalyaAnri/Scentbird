[0m10:13:12.539057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a089d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaccc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aadd8b0>]}


============================== 10:13:12.541582 | c73c1af5-0c69-4f46-bdf7-27672088ecf2 ==============================
[0m10:13:12.541582 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:13:12.541921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt init', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:13:12.544817 [info ] [MainThread]: Setting up your profile.
[0m10:14:21.669863 [info ] [MainThread]: Profile default written to /Users/natalaandrianova/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m10:14:21.709084 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 69.184845, "process_user_time": 1.252304, "process_kernel_time": 0.138826, "process_mem_max_rss": "99614720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:14:21.710405 [debug] [MainThread]: Command `dbt init` succeeded at 10:14:21.710152 after 69.19 seconds
[0m10:14:21.711110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a089d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaccc10>]}
[0m10:14:21.711829 [debug] [MainThread]: Flushing usage events
[0m10:17:55.694931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c8c40>]}


============================== 10:17:55.697554 | ebd15d1e-5c4a-488a-a600-74f5c70ddaa8 ==============================
[0m10:17:55.697554 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:17:55.697882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:55.785882 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'revenue_report', 'description': '—Å–∫–æ–ª—å–∫–æ –≤ –º–µ—Å—è—Ü –∫–æ–º–ø–∞–Ω–∏—è –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ–Ω–µ–≥', 'columns': [{'name': 'report_date', 'type': 'date'}, {'name': 'total_amount', 'type': 'numeric'}]}, {'name': 'deferred_revenue_report', 'description': '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ –≤ –º–µ—Å—è—Ü', 'columns': [{'name': 'report_date', 'type': 'date'}, {'name': 'total_amount', 'type': 'numeric'}]}, {'name': 'marketing_conversion_report', 'description': '—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–Ω–µ—Å–ª–∞ –¥–µ–Ω–µ–≥ —Ä–µ–∫–ª–∞–º–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è', 'columns': [{'name': 'campaign_name', 'type': 'text'}, {'name': 'total_revenue', 'type': 'numeric'}]}] is not of type 'object'

Error encountered in /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/dbt_project.yml
[0m10:17:55.787040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.12585446, "process_user_time": 1.216778, "process_kernel_time": 0.101465, "process_mem_max_rss": "101187584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:17:55.787390 [debug] [MainThread]: Command `dbt run` failed at 10:17:55.787293 after 0.13 seconds
[0m10:17:55.787594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106181940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106181f40>]}
[0m10:17:55.787804 [debug] [MainThread]: Flushing usage events
[0m10:29:18.976219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d886d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a474370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a8610>]}


============================== 10:29:18.979328 | 049084d7-62a8-447f-add6-9c1e775f2c22 ==============================
[0m10:29:18.979328 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:29:18.979678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m10:29:18.983809 [info ] [MainThread]: Setting up your profile.
[0m10:29:23.983359 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 5.0378523, "process_user_time": 1.137902, "process_kernel_time": 0.102541, "process_mem_max_rss": "97091584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:29:23.984721 [debug] [MainThread]: Command `dbt init` succeeded at 10:29:23.984488 after 5.04 seconds
[0m10:29:23.985303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d886d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d99f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a47d040>]}
[0m10:29:23.985914 [debug] [MainThread]: Flushing usage events
[0m10:37:17.230936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024bc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc8640>]}


============================== 10:37:17.233936 | 533ceb7c-3503-4c16-90f5-5e837f18e7da ==============================
[0m10:37:17.233936 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:37:17.234307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:37:17.334376 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'revenue_report', 'description': '—Å–∫–æ–ª—å–∫–æ –≤ –º–µ—Å—è—Ü –∫–æ–º–ø–∞–Ω–∏—è –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ–Ω–µ–≥', 'columns': [{'name': 'report_date', 'type': 'date'}, {'name': 'total_amount', 'type': 'numeric'}]}, {'name': 'deferred_revenue_report', 'description': '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ –≤ –º–µ—Å—è—Ü', 'columns': [{'name': 'report_date', 'type': 'date'}, {'name': 'total_amount', 'type': 'numeric'}]}, {'name': 'marketing_conversion_report', 'description': '—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–Ω–µ—Å–ª–∞ –¥–µ–Ω–µ–≥ —Ä–µ–∫–ª–∞–º–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è', 'columns': [{'name': 'campaign_name', 'type': 'text'}, {'name': 'total_revenue', 'type': 'numeric'}]}] is not of type 'object'

Error encountered in /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/dbt_project.yml
[0m10:37:17.335491 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.13916233, "process_user_time": 1.211128, "process_kernel_time": 0.106124, "process_mem_max_rss": "99762176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:37:17.335848 [debug] [MainThread]: Command `dbt test` failed at 10:37:17.335764 after 0.14 seconds
[0m10:37:17.336068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024bc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9d7f0>]}
[0m10:37:17.336307 [debug] [MainThread]: Flushing usage events
[0m10:39:12.631631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a94400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104559100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459fdc0>]}


============================== 10:39:12.634055 | e4457489-0dcd-4b23-af9c-82a00a0fa4ee ==============================
[0m10:39:12.634055 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:39:12.634379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:39:12.634785 [info ] [MainThread]: dbt version: 1.7.9
[0m10:39:12.634959 [info ] [MainThread]: python version: 3.9.6
[0m10:39:12.635127 [info ] [MainThread]: python path: /Users/natalaandrianova/PycharmProjects/Scentbird/.venv/bin/python
[0m10:39:12.635291 [info ] [MainThread]: os info: macOS-14.3.1-arm64-arm-64bit
[0m10:39:12.685206 [info ] [MainThread]: Using profiles dir at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt
[0m10:39:12.685517 [info ] [MainThread]: Using profiles.yml file at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/profiles.yml
[0m10:39:12.685687 [info ] [MainThread]: Using dbt_project.yml file at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/dbt_project.yml
[0m10:39:12.686997 [info ] [MainThread]: adapter type: postgres
[0m10:39:12.687337 [info ] [MainThread]: adapter version: 1.7.9
[0m10:39:12.726348 [info ] [MainThread]: Configuration:
[0m10:39:12.726568 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:39:12.726725 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m10:39:12.726876 [info ] [MainThread]: Required dependencies:
[0m10:39:12.727072 [debug] [MainThread]: Executing "git --help"
[0m10:39:12.749484 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:39:12.750201 [debug] [MainThread]: STDERR: "b''"
[0m10:39:12.750509 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:39:12.750723 [info ] [MainThread]: Connection:
[0m10:39:12.750977 [info ] [MainThread]:   host: scentbird-exercise.cvxxv2ypq6e7.us-east-1.rds.amazonaws.com
[0m10:39:12.751236 [info ] [MainThread]:   port: 5432
[0m10:39:12.751476 [info ] [MainThread]:   user: nandrianova
[0m10:39:12.751662 [info ] [MainThread]:   database: postgres
[0m10:39:12.751827 [info ] [MainThread]:   schema: public_nandrianova
[0m10:39:12.751997 [info ] [MainThread]:   connect_timeout: 10
[0m10:39:12.752159 [info ] [MainThread]:   role: None
[0m10:39:12.752315 [info ] [MainThread]:   search_path: None
[0m10:39:12.752471 [info ] [MainThread]:   keepalives_idle: 0
[0m10:39:12.752627 [info ] [MainThread]:   sslmode: None
[0m10:39:12.752786 [info ] [MainThread]:   sslcert: None
[0m10:39:12.753096 [info ] [MainThread]:   sslkey: None
[0m10:39:12.753299 [info ] [MainThread]:   sslrootcert: None
[0m10:39:12.753457 [info ] [MainThread]:   application_name: dbt
[0m10:39:12.753609 [info ] [MainThread]:   retries: 1
[0m10:39:12.753923 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:39:12.760518 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:39:12.760988 [debug] [MainThread]: Using postgres connection "debug"
[0m10:39:12.761161 [debug] [MainThread]: On debug: select 1 as id
[0m10:39:12.761337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:14.148012 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m10:39:14.158110 [debug] [MainThread]: On debug: Close
[0m10:39:14.159352 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:39:14.159972 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:39:14.160401 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['models']: [{'name': 'revenue_report', 'description': '—Å–∫–æ–ª—å–∫–æ –≤ –º–µ—Å—è—Ü –∫–æ–º–ø–∞–Ω–∏—è –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–µ–Ω–µ–≥', 'columns': [{'name': 'report_date', 'type': 'date'}, {'name': 'total_amount', 'type': 'numeric'}]}, {'name': 'deferred_revenue_report', 'description': '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ –≤ –º–µ—Å—è—Ü', 'columns': [{'name': 'report_date', 'type': 'date'}, {'name': 'total_amount', 'type': 'numeric'}]}, {'name': 'marketing_conversion_report', 'description': '—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–Ω–µ—Å–ª–∞ –¥–µ–Ω–µ–≥ —Ä–µ–∫–ª–∞–º–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è', 'columns': [{'name': 'campaign_name', 'type': 'text'}, {'name': 'total_revenue', 'type': 'numeric'}]}] is not of type 'object'

Error encountered in /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/dbt_project.yml


[0m10:39:14.163082 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.5640442, "process_user_time": 1.264568, "process_kernel_time": 0.114982, "process_mem_max_rss": "113655808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:39:14.163951 [debug] [MainThread]: Command `dbt debug` failed at 10:39:14.163768 after 1.57 seconds
[0m10:39:14.164540 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:39:14.165053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a94400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dc130>]}
[0m10:39:14.165669 [debug] [MainThread]: Flushing usage events
[0m10:39:47.430476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e386d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e2f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e61610>]}


============================== 10:39:47.433109 | 9d00db3b-72dd-45b4-b9c3-8a9c797955fe ==============================
[0m10:39:47.433109 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:39:47.433482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:39:47.433889 [info ] [MainThread]: dbt version: 1.7.9
[0m10:39:47.434071 [info ] [MainThread]: python version: 3.9.6
[0m10:39:47.434244 [info ] [MainThread]: python path: /Users/natalaandrianova/PycharmProjects/Scentbird/.venv/bin/python
[0m10:39:47.434413 [info ] [MainThread]: os info: macOS-14.3.1-arm64-arm-64bit
[0m10:39:47.487296 [info ] [MainThread]: Using profiles dir at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt
[0m10:39:47.487595 [info ] [MainThread]: Using profiles.yml file at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/profiles.yml
[0m10:39:47.487779 [info ] [MainThread]: Using dbt_project.yml file at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/dbt_project.yml
[0m10:39:47.488078 [info ] [MainThread]: adapter type: postgres
[0m10:39:47.488250 [info ] [MainThread]: adapter version: 1.7.9
[0m10:39:47.525405 [info ] [MainThread]: Configuration:
[0m10:39:47.525726 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:39:47.525916 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m10:39:47.526096 [info ] [MainThread]: Required dependencies:
[0m10:39:47.526334 [debug] [MainThread]: Executing "git --help"
[0m10:39:47.535266 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:39:47.535825 [debug] [MainThread]: STDERR: "b''"
[0m10:39:47.536077 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:39:47.536284 [info ] [MainThread]: Connection:
[0m10:39:47.536528 [info ] [MainThread]:   host: scentbird-exercise.cvxxv2ypq6e7.us-east-1.rds.amazonaws.com
[0m10:39:47.536700 [info ] [MainThread]:   port: 5432
[0m10:39:47.536868 [info ] [MainThread]:   user: nandrianova
[0m10:39:47.537037 [info ] [MainThread]:   database: postgres
[0m10:39:47.537204 [info ] [MainThread]:   schema: public_nandrianova
[0m10:39:47.537380 [info ] [MainThread]:   connect_timeout: 10
[0m10:39:47.537561 [info ] [MainThread]:   role: None
[0m10:39:47.537726 [info ] [MainThread]:   search_path: None
[0m10:39:47.537903 [info ] [MainThread]:   keepalives_idle: 0
[0m10:39:47.538071 [info ] [MainThread]:   sslmode: None
[0m10:39:47.538233 [info ] [MainThread]:   sslcert: None
[0m10:39:47.538397 [info ] [MainThread]:   sslkey: None
[0m10:39:47.538586 [info ] [MainThread]:   sslrootcert: None
[0m10:39:47.538746 [info ] [MainThread]:   application_name: dbt
[0m10:39:47.538912 [info ] [MainThread]:   retries: 1
[0m10:39:47.539228 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:39:47.542836 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:39:47.543369 [debug] [MainThread]: Using postgres connection "debug"
[0m10:39:47.543566 [debug] [MainThread]: On debug: select 1 as id
[0m10:39:47.543766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:48.941081 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m10:39:48.944883 [debug] [MainThread]: On debug: Close
[0m10:39:48.945385 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:39:48.945676 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:39:48.945896 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['sources']: [{'name': 'events', 'type': 'postgres', 'database': 'postgres', 'schema': 'public_exercises', 'table': 'events'}, {'name': 'orders', 'type': 'postgres', 'database': 'postgres', 'schema': 'public_exercises', 'table': 'orders'}, {'name': 'users', 'type': 'postgres', 'database': 'postgres', 'schema': 'public_exercises', 'table': 'users'}] is not of type 'object'

Error encountered in /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/dbt_project.yml


[0m10:39:48.947224 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.5508292, "process_user_time": 1.26744, "process_kernel_time": 0.105889, "process_mem_max_rss": "113786880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:39:48.947691 [debug] [MainThread]: Command `dbt debug` failed at 10:39:48.947568 after 1.55 seconds
[0m10:39:48.947954 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:39:48.948195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e386d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cb100>]}
[0m10:39:48.948502 [debug] [MainThread]: Flushing usage events
[0m10:40:14.242178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113874430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113867b50>]}


============================== 10:40:14.244867 | 1b6e1ced-11a1-493e-af0b-4daf7b160e85 ==============================
[0m10:40:14.244867 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:40:14.245221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:40:14.245621 [info ] [MainThread]: dbt version: 1.7.9
[0m10:40:14.245795 [info ] [MainThread]: python version: 3.9.6
[0m10:40:14.245960 [info ] [MainThread]: python path: /Users/natalaandrianova/PycharmProjects/Scentbird/.venv/bin/python
[0m10:40:14.246122 [info ] [MainThread]: os info: macOS-14.3.1-arm64-arm-64bit
[0m10:40:14.297791 [info ] [MainThread]: Using profiles dir at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt
[0m10:40:14.298136 [info ] [MainThread]: Using profiles.yml file at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/profiles.yml
[0m10:40:14.298313 [info ] [MainThread]: Using dbt_project.yml file at /Users/natalaandrianova/PycharmProjects/Scentbird/dbt/dbt_project.yml
[0m10:40:14.298642 [info ] [MainThread]: adapter type: postgres
[0m10:40:14.298810 [info ] [MainThread]: adapter version: 1.7.9
[0m10:40:14.342716 [info ] [MainThread]: Configuration:
[0m10:40:14.343059 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:40:14.343231 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:40:14.343388 [info ] [MainThread]: Required dependencies:
[0m10:40:14.343617 [debug] [MainThread]: Executing "git --help"
[0m10:40:14.353276 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:40:14.353875 [debug] [MainThread]: STDERR: "b''"
[0m10:40:14.354107 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:40:14.354297 [info ] [MainThread]: Connection:
[0m10:40:14.354591 [info ] [MainThread]:   host: scentbird-exercise.cvxxv2ypq6e7.us-east-1.rds.amazonaws.com
[0m10:40:14.354829 [info ] [MainThread]:   port: 5432
[0m10:40:14.355006 [info ] [MainThread]:   user: nandrianova
[0m10:40:14.355173 [info ] [MainThread]:   database: postgres
[0m10:40:14.355340 [info ] [MainThread]:   schema: public_nandrianova
[0m10:40:14.355496 [info ] [MainThread]:   connect_timeout: 10
[0m10:40:14.355655 [info ] [MainThread]:   role: None
[0m10:40:14.355817 [info ] [MainThread]:   search_path: None
[0m10:40:14.355968 [info ] [MainThread]:   keepalives_idle: 0
[0m10:40:14.356117 [info ] [MainThread]:   sslmode: None
[0m10:40:14.356262 [info ] [MainThread]:   sslcert: None
[0m10:40:14.356412 [info ] [MainThread]:   sslkey: None
[0m10:40:14.356563 [info ] [MainThread]:   sslrootcert: None
[0m10:40:14.356715 [info ] [MainThread]:   application_name: dbt
[0m10:40:14.356865 [info ] [MainThread]:   retries: 1
[0m10:40:14.357192 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:40:14.361036 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:40:14.361760 [debug] [MainThread]: Using postgres connection "debug"
[0m10:40:14.362003 [debug] [MainThread]: On debug: select 1 as id
[0m10:40:14.362181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:16.198584 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m10:40:16.203383 [debug] [MainThread]: On debug: Close
[0m10:40:16.204784 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:40:16.205426 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:40:16.208882 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0026357, "process_user_time": 1.287056, "process_kernel_time": 0.113402, "process_mem_max_rss": "113557504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:40:16.209924 [debug] [MainThread]: Command `dbt debug` succeeded at 10:40:16.209714 after 2.00 seconds
[0m10:40:16.210443 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:40:16.210995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113810910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e1c1f0>]}
[0m10:40:16.211698 [debug] [MainThread]: Flushing usage events
[0m10:40:31.571618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f00400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a18040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0df70>]}


============================== 10:40:31.574037 | ff6a6663-96e7-4a79-a26c-ad46f861cf46 ==============================
[0m10:40:31.574037 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:40:31.574370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:31.690819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff6a6663-96e7-4a79-a26c-ad46f861cf46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a18040>]}
[0m10:40:31.739052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff6a6663-96e7-4a79-a26c-ad46f861cf46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec3670>]}
[0m10:40:31.739502 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:40:31.750346 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m10:40:31.750798 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:40:31.751029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff6a6663-96e7-4a79-a26c-ad46f861cf46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e82fa0>]}
[0m10:40:32.242797 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Scentbird.revenue_report' (models/revenue_report.sql) depends on a node named 'orders' which was not found
[0m10:40:32.243918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7049767, "process_user_time": 1.760657, "process_kernel_time": 0.111268, "process_mem_max_rss": "108412928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:40:32.244201 [debug] [MainThread]: Command `dbt run` failed at 10:40:32.244133 after 0.71 seconds
[0m10:40:32.244422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f00400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c1d00>]}
[0m10:40:32.244638 [debug] [MainThread]: Flushing usage events
[0m10:49:45.363099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032086d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105936280>]}


============================== 10:49:45.365558 | 62750234-1f95-45e8-89dd-a342aab82a1a ==============================
[0m10:49:45.365558 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:49:45.365902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:49:45.464398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62750234-1f95-45e8-89dd-a342aab82a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a6a30>]}
[0m10:49:45.512215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62750234-1f95-45e8-89dd-a342aab82a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be6a30>]}
[0m10:49:45.512682 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:49:45.521790 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m10:49:45.522270 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:49:45.522498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '62750234-1f95-45e8-89dd-a342aab82a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d97d30>]}
[0m10:49:45.996669 [error] [MainThread]: Encountered an error:
Compilation Error in model revenue_report (models/revenue_report.sql)
  source() takes exactly two arguments (1 given)
[0m10:49:45.997766 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.66922736, "process_user_time": 1.71989, "process_kernel_time": 0.109543, "process_mem_max_rss": "106315776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:49:45.998075 [debug] [MainThread]: Command `dbt source freshness` failed at 10:49:45.998007 after 0.67 seconds
[0m10:49:45.998284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032086d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106576e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106576cd0>]}
[0m10:49:45.998499 [debug] [MainThread]: Flushing usage events
[0m10:50:44.843633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045889d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106371a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b62b0>]}


============================== 10:50:44.845985 | 10429086-ad0e-4f0b-8f7c-f6fedb9b3ec1 ==============================
[0m10:50:44.845985 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:50:44.846342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:50:44.944944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10429086-ad0e-4f0b-8f7c-f6fedb9b3ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063913a0>]}
[0m10:50:44.992449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10429086-ad0e-4f0b-8f7c-f6fedb9b3ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687b130>]}
[0m10:50:44.992967 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:50:45.002148 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m10:50:45.002642 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:50:45.002868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '10429086-ad0e-4f0b-8f7c-f6fedb9b3ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106959af0>]}
[0m10:50:45.523946 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/public_exercises.yml @ sources: {'name': 'public_exercises_table', 'schema': 'public_exercises', 'type': 'postgres', 'database': 'postgres', 'tables': [{'name': 'events'}, {'name': 'orders'}, {'name': 'users'}]} - at path []: Additional properties are not allowed ('type' was unexpected)
[0m10:50:45.525079 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.7136457, "process_user_time": 1.794055, "process_kernel_time": 0.110175, "process_mem_max_rss": "110346240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:50:45.525409 [debug] [MainThread]: Command `dbt source freshness` failed at 10:50:45.525339 after 0.71 seconds
[0m10:50:45.525628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045889d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068825b0>]}
[0m10:50:45.525858 [debug] [MainThread]: Flushing usage events
[0m10:51:03.057918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a48400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063722b0>]}


============================== 10:51:03.060339 | 302d1c9e-715f-4077-91d7-59ae3cc284e8 ==============================
[0m10:51:03.060339 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:51:03.060665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:51:03.160747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '302d1c9e-715f-4077-91d7-59ae3cc284e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634c2e0>]}
[0m10:51:03.208692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '302d1c9e-715f-4077-91d7-59ae3cc284e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b6730>]}
[0m10:51:03.209154 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:51:03.218426 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m10:51:03.218897 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:51:03.219131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '302d1c9e-715f-4077-91d7-59ae3cc284e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068db2b0>]}
[0m10:51:03.757703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '302d1c9e-715f-4077-91d7-59ae3cc284e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071620d0>]}
[0m10:51:03.764012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '302d1c9e-715f-4077-91d7-59ae3cc284e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bfe20>]}
[0m10:51:03.764279 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:51:03.764478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '302d1c9e-715f-4077-91d7-59ae3cc284e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f34640>]}
[0m10:51:03.765192 [info ] [MainThread]: 
[0m10:51:03.765380 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:51:03.769705 [info ] [MainThread]: Done.
[0m10:51:03.770700 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.7455375, "process_user_time": 1.832776, "process_kernel_time": 0.11591, "process_mem_max_rss": "114868224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:51:03.771022 [debug] [MainThread]: Command `dbt source freshness` succeeded at 10:51:03.770950 after 0.75 seconds
[0m10:51:03.771414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a48400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106faeca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b6730>]}
[0m10:51:03.771674 [debug] [MainThread]: Flushing usage events
[0m10:51:14.392769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104788400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106570040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106565f70>]}


============================== 10:51:14.395138 | a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c ==============================
[0m10:51:14.395138 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:51:14.395476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:51:14.493687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106570040>]}
[0m10:51:14.541830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b670>]}
[0m10:51:14.542436 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:51:14.552091 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m10:51:14.571868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:14.572124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:14.575726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713cf40>]}
[0m10:51:14.582626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107060220>]}
[0m10:51:14.582975 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:51:14.583190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107060250>]}
[0m10:51:14.584171 [info ] [MainThread]: 
[0m10:51:14.584635 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:14.585234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:51:14.591608 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:51:14.591886 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:51:14.592055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:16.404181 [debug] [ThreadPool]: SQL status: SELECT 9 in 2.0 seconds
[0m10:51:16.407234 [debug] [ThreadPool]: On list_postgres: Close
[0m10:51:16.410180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_nandrianova)
[0m10:51:16.419173 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m10:51:16.419620 [debug] [ThreadPool]: On list_postgres_public_nandrianova: BEGIN
[0m10:51:16.419975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:18.173199 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m10:51:18.174867 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m10:51:18.176203 [debug] [ThreadPool]: On list_postgres_public_nandrianova: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres_public_nandrianova"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_nandrianova'
  
[0m10:51:18.373777 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:51:18.377949 [debug] [ThreadPool]: On list_postgres_public_nandrianova: ROLLBACK
[0m10:51:18.575406 [debug] [ThreadPool]: On list_postgres_public_nandrianova: Close
[0m10:51:18.585421 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:18.585960 [debug] [MainThread]: On master: BEGIN
[0m10:51:18.586363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:20.382886 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m10:51:20.385401 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:20.386548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:20.583377 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m10:51:20.590760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b65e0>]}
[0m10:51:20.592909 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:20.784618 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:20.786779 [debug] [MainThread]: On master: BEGIN
[0m10:51:21.146153 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:51:21.148212 [debug] [MainThread]: On master: COMMIT
[0m10:51:21.148875 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:21.149683 [debug] [MainThread]: On master: COMMIT
[0m10:51:21.349121 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:21.350921 [debug] [MainThread]: On master: Close
[0m10:51:21.353440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:21.354308 [info ] [MainThread]: 
[0m10:51:21.359955 [debug] [Thread-1  ]: Began running node model.Scentbird.revenue_report
[0m10:51:21.360764 [info ] [Thread-1  ]: 1 of 1 START sql view model public_nandrianova.revenue_report .................. [RUN]
[0m10:51:21.361741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_nandrianova, now model.Scentbird.revenue_report)
[0m10:51:21.362247 [debug] [Thread-1  ]: Began compiling node model.Scentbird.revenue_report
[0m10:51:21.373584 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.revenue_report"
[0m10:51:21.374991 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (compile): 10:51:21.362552 => 10:51:21.374714
[0m10:51:21.375403 [debug] [Thread-1  ]: Began executing node model.Scentbird.revenue_report
[0m10:51:21.404855 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.revenue_report"
[0m10:51:21.405609 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m10:51:21.405860 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: BEGIN
[0m10:51:21.406093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:51:23.045030 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m10:51:23.047421 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m10:51:23.048700 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */

  create view "postgres"."public_nandrianova"."revenue_report__dbt_tmp"
    
    
  as (
    select date_trunc('month', created_at)::date as report_date
     , sum(amount)                           as total_amount
from "postgres"."public_exercises"."orders"
group by report_date
;
  );
[0m10:51:23.189669 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 11: ;
         ^

[0m10:51:23.190901 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: ROLLBACK
[0m10:51:23.329010 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (execute): 10:51:21.375636 => 10:51:23.327163
[0m10:51:23.330545 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: Close
[0m10:51:23.363818 [debug] [Thread-1  ]: Database Error in model revenue_report (models/revenue_report.sql)
  syntax error at or near ";"
  LINE 11: ;
           ^
  compiled Code at target/run/Scentbird/models/revenue_report.sql
[0m10:51:23.364321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a743ea92-ba2d-4c9f-944c-0c9f4dcf9a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107161fd0>]}
[0m10:51:23.364861 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public_nandrianova.revenue_report ......... [[31mERROR[0m in 2.00s]
[0m10:51:23.365333 [debug] [Thread-1  ]: Finished running node model.Scentbird.revenue_report
[0m10:51:23.366352 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:23.366630 [debug] [MainThread]: On master: BEGIN
[0m10:51:23.366860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:24.637514 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m10:51:24.639224 [debug] [MainThread]: On master: COMMIT
[0m10:51:24.639891 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:24.640695 [debug] [MainThread]: On master: COMMIT
[0m10:51:24.778729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:24.779892 [debug] [MainThread]: On master: Close
[0m10:51:24.782682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:24.783633 [debug] [MainThread]: Connection 'model.Scentbird.revenue_report' was properly closed.
[0m10:51:24.784413 [info ] [MainThread]: 
[0m10:51:24.785085 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.20 seconds (10.20s).
[0m10:51:24.786251 [debug] [MainThread]: Command end result
[0m10:51:24.798528 [info ] [MainThread]: 
[0m10:51:24.799024 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:51:24.799381 [info ] [MainThread]: 
[0m10:51:24.799744 [error] [MainThread]:   Database Error in model revenue_report (models/revenue_report.sql)
  syntax error at or near ";"
  LINE 11: ;
           ^
  compiled Code at target/run/Scentbird/models/revenue_report.sql
[0m10:51:24.800095 [info ] [MainThread]: 
[0m10:51:24.800477 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:51:24.802864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.442346, "process_user_time": 1.54414, "process_kernel_time": 0.148603, "process_mem_max_rss": "120078336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:51:24.803515 [debug] [MainThread]: Command `dbt run` failed at 10:51:24.803389 after 10.44 seconds
[0m10:51:24.803978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104788400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0d7c0>]}
[0m10:51:24.804410 [debug] [MainThread]: Flushing usage events
[0m10:51:37.868373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104630490>]}


============================== 10:51:37.870759 | a53e1edd-f469-4163-b9d4-bc3523fb9783 ==============================
[0m10:51:37.870759 [info ] [MainThread]: Running with dbt=1.7.9
[0m10:51:37.871112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:37.974752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a53e1edd-f469-4163-b9d4-bc3523fb9783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a755b0>]}
[0m10:51:38.023295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a53e1edd-f469-4163-b9d4-bc3523fb9783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dddc0>]}
[0m10:51:38.023852 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m10:51:38.033294 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m10:51:38.051963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:51:38.052389 [debug] [MainThread]: Partial parsing: updated file: Scentbird://models/revenue_report.sql
[0m10:51:38.130980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a53e1edd-f469-4163-b9d4-bc3523fb9783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054250d0>]}
[0m10:51:38.137423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a53e1edd-f469-4163-b9d4-bc3523fb9783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105120280>]}
[0m10:51:38.137733 [info ] [MainThread]: Found 1 model, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:51:38.137954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a53e1edd-f469-4163-b9d4-bc3523fb9783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051202b0>]}
[0m10:51:38.138814 [info ] [MainThread]: 
[0m10:51:38.139241 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:38.139805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m10:51:38.146206 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:51:38.146455 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:51:38.146627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:39.955896 [debug] [ThreadPool]: SQL status: SELECT 9 in 2.0 seconds
[0m10:51:39.960360 [debug] [ThreadPool]: On list_postgres: Close
[0m10:51:39.963336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_nandrianova)
[0m10:51:40.014418 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m10:51:40.014745 [debug] [ThreadPool]: On list_postgres_public_nandrianova: BEGIN
[0m10:51:40.014943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:41.719670 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m10:51:41.721871 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m10:51:41.722583 [debug] [ThreadPool]: On list_postgres_public_nandrianova: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres_public_nandrianova"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_nandrianova'
  
[0m10:51:41.919756 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:51:41.924305 [debug] [ThreadPool]: On list_postgres_public_nandrianova: ROLLBACK
[0m10:51:42.121061 [debug] [ThreadPool]: On list_postgres_public_nandrianova: Close
[0m10:51:42.126785 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:42.127120 [debug] [MainThread]: On master: BEGIN
[0m10:51:42.127354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:43.824390 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m10:51:43.826431 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:43.827312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:43.973583 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m10:51:43.978756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a53e1edd-f469-4163-b9d4-bc3523fb9783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547c7f0>]}
[0m10:51:43.979681 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:44.118137 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:44.119817 [debug] [MainThread]: On master: BEGIN
[0m10:51:44.396500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:51:44.398446 [debug] [MainThread]: On master: COMMIT
[0m10:51:44.399250 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:44.400072 [debug] [MainThread]: On master: COMMIT
[0m10:51:44.538303 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:44.539816 [debug] [MainThread]: On master: Close
[0m10:51:44.541877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:44.542522 [info ] [MainThread]: 
[0m10:51:44.546395 [debug] [Thread-1  ]: Began running node model.Scentbird.revenue_report
[0m10:51:44.547268 [info ] [Thread-1  ]: 1 of 1 START sql view model public_nandrianova.revenue_report .................. [RUN]
[0m10:51:44.548263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_nandrianova, now model.Scentbird.revenue_report)
[0m10:51:44.548766 [debug] [Thread-1  ]: Began compiling node model.Scentbird.revenue_report
[0m10:51:44.559849 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.revenue_report"
[0m10:51:44.561026 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (compile): 10:51:44.549062 => 10:51:44.560781
[0m10:51:44.561398 [debug] [Thread-1  ]: Began executing node model.Scentbird.revenue_report
[0m10:51:44.592130 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.revenue_report"
[0m10:51:44.592785 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m10:51:44.593031 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: BEGIN
[0m10:51:44.593258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:51:45.866179 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m10:51:45.866975 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m10:51:45.867396 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */

  create view "postgres"."public_nandrianova"."revenue_report__dbt_tmp"
    
    
  as (
    select date_trunc('month', created_at)::date as report_date
     , sum(amount)                           as total_amount
from "postgres"."public_exercises"."orders"
group by report_date
  );
[0m10:51:46.011428 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:51:46.022669 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m10:51:46.023190 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
alter table "postgres"."public_nandrianova"."revenue_report__dbt_tmp" rename to "revenue_report"
[0m10:51:46.162552 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:46.177890 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m10:51:46.178282 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m10:51:46.178542 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m10:51:46.318433 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:51:46.323873 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."revenue_report__dbt_backup"
[0m10:51:46.327007 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m10:51:46.327278 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
drop view if exists "postgres"."public_nandrianova"."revenue_report__dbt_backup" cascade
[0m10:51:46.467798 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:51:46.469833 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (execute): 10:51:44.561610 => 10:51:46.469560
[0m10:51:46.470297 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: Close
[0m10:51:46.471517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a53e1edd-f469-4163-b9d4-bc3523fb9783', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055418b0>]}
[0m10:51:46.472293 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public_nandrianova.revenue_report ............. [[32mCREATE VIEW[0m in 1.92s]
[0m10:51:46.472971 [debug] [Thread-1  ]: Finished running node model.Scentbird.revenue_report
[0m10:51:46.474537 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:46.474891 [debug] [MainThread]: On master: BEGIN
[0m10:51:46.475184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:47.722572 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m10:51:47.724478 [debug] [MainThread]: On master: COMMIT
[0m10:51:47.725179 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:47.725818 [debug] [MainThread]: On master: COMMIT
[0m10:51:47.862586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:47.864469 [debug] [MainThread]: On master: Close
[0m10:51:47.866922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:47.867720 [debug] [MainThread]: Connection 'model.Scentbird.revenue_report' was properly closed.
[0m10:51:47.868320 [info ] [MainThread]: 
[0m10:51:47.868903 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m10:51:47.870027 [debug] [MainThread]: Command end result
[0m10:51:47.881331 [info ] [MainThread]: 
[0m10:51:47.881849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:47.882228 [info ] [MainThread]: 
[0m10:51:47.882648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:51:47.884917 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.049829, "process_user_time": 1.691721, "process_kernel_time": 0.153031, "process_mem_max_rss": "123076608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:51:47.885459 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:47.885336 after 10.05 seconds
[0m10:51:47.885884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105504250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104afd400>]}
[0m10:51:47.886320 [debug] [MainThread]: Flushing usage events
[0m11:02:43.570150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107048400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c722b0>]}


============================== 11:02:43.573025 | c8eed735-9d56-4c89-982c-9d9d8cc65f1a ==============================
[0m11:02:43.573025 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:02:43.573364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:02:43.698203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8eed735-9d56-4c89-982c-9d9d8cc65f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4d2e0>]}
[0m11:02:43.746134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8eed735-9d56-4c89-982c-9d9d8cc65f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b6730>]}
[0m11:02:43.746870 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m11:02:43.757251 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:02:43.780675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:02:43.781056 [debug] [MainThread]: Partial parsing: added file: Scentbird://models/deferred_revenue_report.sql
[0m11:02:43.858026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8eed735-9d56-4c89-982c-9d9d8cc65f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea40d0>]}
[0m11:02:43.864415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8eed735-9d56-4c89-982c-9d9d8cc65f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d46bb0>]}
[0m11:02:43.864702 [info ] [MainThread]: Found 2 models, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:02:43.864916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8eed735-9d56-4c89-982c-9d9d8cc65f1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109203220>]}
[0m11:02:43.865715 [info ] [MainThread]: 
[0m11:02:43.865919 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:02:43.895196 [info ] [MainThread]: Done.
[0m11:02:43.896216 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.36069125, "process_user_time": 1.406188, "process_kernel_time": 0.131257, "process_mem_max_rss": "109510656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:02:43.896513 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:02:43.896445 after 0.36 seconds
[0m11:02:43.896723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107048400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b832b0>]}
[0m11:02:43.896934 [debug] [MainThread]: Flushing usage events
[0m11:03:02.724426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca46d0>]}


============================== 11:03:02.726805 | 90fe2e96-612e-4653-9c3e-97c269b942a4 ==============================
[0m11:03:02.726805 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:03:02.727141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:03:02.828515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1465b0>]}
[0m11:03:02.876174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a016cd0>]}
[0m11:03:02.876653 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m11:03:02.885719 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:03:02.904328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:02.904584 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:02.908255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aafe0d0>]}
[0m11:03:02.914511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2a6a0>]}
[0m11:03:02.914790 [info ] [MainThread]: Found 2 models, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:03:02.915001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2a700>]}
[0m11:03:02.915939 [info ] [MainThread]: 
[0m11:03:02.916362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:02.916957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:03:02.922948 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:03:02.923264 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:03:02.923498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:04.835884 [debug] [ThreadPool]: SQL status: SELECT 9 in 2.0 seconds
[0m11:03:04.841310 [debug] [ThreadPool]: On list_postgres: Close
[0m11:03:04.844594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_nandrianova)
[0m11:03:04.853729 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:03:04.854179 [debug] [ThreadPool]: On list_postgres_public_nandrianova: BEGIN
[0m11:03:04.854540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:06.553705 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m11:03:06.554811 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:03:06.555716 [debug] [ThreadPool]: On list_postgres_public_nandrianova: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres_public_nandrianova"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_nandrianova'
  
[0m11:03:06.754888 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m11:03:06.759349 [debug] [ThreadPool]: On list_postgres_public_nandrianova: ROLLBACK
[0m11:03:06.954215 [debug] [ThreadPool]: On list_postgres_public_nandrianova: Close
[0m11:03:06.967081 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:06.967696 [debug] [MainThread]: On master: BEGIN
[0m11:03:06.968101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:08.714507 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m11:03:08.716638 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:08.718641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:08.913961 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m11:03:08.919349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94dee0>]}
[0m11:03:08.920216 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:09.115409 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:09.118749 [debug] [MainThread]: On master: BEGIN
[0m11:03:09.474369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:09.476626 [debug] [MainThread]: On master: COMMIT
[0m11:03:09.477710 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:09.478551 [debug] [MainThread]: On master: COMMIT
[0m11:03:09.675380 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:09.677104 [debug] [MainThread]: On master: Close
[0m11:03:09.679146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:09.679797 [info ] [MainThread]: 
[0m11:03:09.684853 [debug] [Thread-1  ]: Began running node model.Scentbird.deferred_revenue_report
[0m11:03:09.685749 [info ] [Thread-1  ]: 1 of 2 START sql view model public_nandrianova.deferred_revenue_report ......... [RUN]
[0m11:03:09.686848 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_nandrianova, now model.Scentbird.deferred_revenue_report)
[0m11:03:09.687500 [debug] [Thread-1  ]: Began compiling node model.Scentbird.deferred_revenue_report
[0m11:03:09.699034 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.deferred_revenue_report"
[0m11:03:09.700527 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (compile): 11:03:09.687830 => 11:03:09.700248
[0m11:03:09.700962 [debug] [Thread-1  ]: Began executing node model.Scentbird.deferred_revenue_report
[0m11:03:09.731538 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.deferred_revenue_report"
[0m11:03:09.732127 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:03:09.732383 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: BEGIN
[0m11:03:09.732620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:03:11.434731 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m11:03:11.436935 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:03:11.437784 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */

  create view "postgres"."public_nandrianova"."deferred_revenue_report__dbt_tmp"
    
    
  as (
    with pre_t as (select date_trunc('month', created_at)::date as created_month
                    , date_trunc('month', shipped_at)::date as shipped_month
                    , id
                    , amount
               from "postgres"."public_exercises"."orders")
select created_month as report_date
     , count(id)     as count_orders
     , sum(amount)   as total_amount
from pre_t
where 1 = 1
  and created_month != shipped_month
group by report_date
  );
[0m11:03:11.634179 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:03:11.648749 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:03:11.649314 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
alter table "postgres"."public_nandrianova"."deferred_revenue_report__dbt_tmp" rename to "deferred_revenue_report"
[0m11:03:11.834288 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:03:11.858618 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: COMMIT
[0m11:03:11.859238 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:03:11.859615 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: COMMIT
[0m11:03:12.033352 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:03:12.048219 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."deferred_revenue_report__dbt_backup"
[0m11:03:12.054417 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:03:12.055065 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
drop view if exists "postgres"."public_nandrianova"."deferred_revenue_report__dbt_backup" cascade
[0m11:03:12.233623 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:03:12.239696 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (execute): 11:03:09.701193 => 11:03:12.239352
[0m11:03:12.240300 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: Close
[0m11:03:12.242035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab25c40>]}
[0m11:03:12.243323 [info ] [Thread-1  ]: 1 of 2 OK created sql view model public_nandrianova.deferred_revenue_report .... [[32mCREATE VIEW[0m in 2.56s]
[0m11:03:12.244438 [debug] [Thread-1  ]: Finished running node model.Scentbird.deferred_revenue_report
[0m11:03:12.245094 [debug] [Thread-1  ]: Began running node model.Scentbird.revenue_report
[0m11:03:12.245734 [info ] [Thread-1  ]: 2 of 2 START sql view model public_nandrianova.revenue_report .................. [RUN]
[0m11:03:12.246946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.Scentbird.deferred_revenue_report, now model.Scentbird.revenue_report)
[0m11:03:12.247492 [debug] [Thread-1  ]: Began compiling node model.Scentbird.revenue_report
[0m11:03:12.251805 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.revenue_report"
[0m11:03:12.256461 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (compile): 11:03:12.247771 => 11:03:12.256201
[0m11:03:12.256884 [debug] [Thread-1  ]: Began executing node model.Scentbird.revenue_report
[0m11:03:12.263426 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.revenue_report"
[0m11:03:12.264226 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:03:12.264608 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: BEGIN
[0m11:03:12.264958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:03:13.954157 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m11:03:13.956785 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:03:13.957728 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */

  create view "postgres"."public_nandrianova"."revenue_report__dbt_tmp"
    
    
  as (
    select date_trunc('month', created_at)::date as report_date
     , sum(amount)                           as total_amount
from "postgres"."public_exercises"."orders"
group by report_date
  );
[0m11:03:14.153803 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:03:14.221683 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:03:14.222029 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
alter table "postgres"."public_nandrianova"."revenue_report" rename to "revenue_report__dbt_backup"
[0m11:03:14.393171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:03:14.398145 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:03:14.398619 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
alter table "postgres"."public_nandrianova"."revenue_report__dbt_tmp" rename to "revenue_report"
[0m11:03:14.593239 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:03:14.602651 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m11:03:14.603317 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:03:14.603804 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m11:03:14.793691 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:03:14.800431 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."revenue_report__dbt_backup"
[0m11:03:14.801931 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:03:14.802457 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
drop view if exists "postgres"."public_nandrianova"."revenue_report__dbt_backup" cascade
[0m11:03:14.993853 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:03:14.999603 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (execute): 11:03:12.257129 => 11:03:14.999183
[0m11:03:15.000405 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: Close
[0m11:03:15.002169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90fe2e96-612e-4653-9c3e-97c269b942a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3fc40>]}
[0m11:03:15.003288 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public_nandrianova.revenue_report ............. [[32mCREATE VIEW[0m in 2.76s]
[0m11:03:15.004113 [debug] [Thread-1  ]: Finished running node model.Scentbird.revenue_report
[0m11:03:15.006155 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:15.006667 [debug] [MainThread]: On master: BEGIN
[0m11:03:15.007079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:16.547321 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m11:03:16.548211 [debug] [MainThread]: On master: COMMIT
[0m11:03:16.548660 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:16.549072 [debug] [MainThread]: On master: COMMIT
[0m11:03:16.686601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:16.688459 [debug] [MainThread]: On master: Close
[0m11:03:16.690977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:16.691638 [debug] [MainThread]: Connection 'model.Scentbird.revenue_report' was properly closed.
[0m11:03:16.692261 [info ] [MainThread]: 
[0m11:03:16.692861 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 13.78 seconds (13.78s).
[0m11:03:16.694228 [debug] [MainThread]: Command end result
[0m11:03:16.705768 [info ] [MainThread]: 
[0m11:03:16.706319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:16.706694 [info ] [MainThread]: 
[0m11:03:16.707106 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:03:16.709353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.017296, "process_user_time": 1.744736, "process_kernel_time": 0.168228, "process_mem_max_rss": "120864768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:03:16.710034 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:16.709878 after 14.02 seconds
[0m11:03:16.710505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af3fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94d6d0>]}
[0m11:03:16.710976 [debug] [MainThread]: Flushing usage events
[0m11:29:07.020956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103220400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3a2b0>]}


============================== 11:29:07.024240 | 512bfd27-cccb-4581-a16a-998414098df5 ==============================
[0m11:29:07.024240 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:29:07.024581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m11:29:07.155438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '512bfd27-cccb-4581-a16a-998414098df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d142e0>]}
[0m11:29:07.203572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '512bfd27-cccb-4581-a16a-998414098df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517e730>]}
[0m11:29:07.204210 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m11:29:07.214053 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:29:07.240294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:29:07.240672 [debug] [MainThread]: Partial parsing: added file: Scentbird://models/marketing_conversion_report.sql
[0m11:29:07.240914 [debug] [MainThread]: Partial parsing: updated file: Scentbird://models/deferred_revenue_report.sql
[0m11:29:07.321229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '512bfd27-cccb-4581-a16a-998414098df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590efd0>]}
[0m11:29:07.327861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '512bfd27-cccb-4581-a16a-998414098df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571d0d0>]}
[0m11:29:07.328147 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:29:07.328362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '512bfd27-cccb-4581-a16a-998414098df5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bab20>]}
[0m11:29:07.329188 [info ] [MainThread]: 
[0m11:29:07.329386 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:29:07.359729 [info ] [MainThread]: Done.
[0m11:29:07.360751 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.37701422, "process_user_time": 1.404769, "process_kernel_time": 0.136816, "process_mem_max_rss": "109379584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:29:07.361073 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:29:07.360996 after 0.38 seconds
[0m11:29:07.361291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103220400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e4f70>]}
[0m11:29:07.361515 [debug] [MainThread]: Flushing usage events
[0m11:29:52.372851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f88400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116afa30>]}


============================== 11:29:52.375317 | 2ea94647-b79b-472e-aa64-dbeb79dab534 ==============================
[0m11:29:52.375317 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:29:52.375647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:52.477392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693ae50>]}
[0m11:29:52.525098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c64670>]}
[0m11:29:52.525593 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m11:29:52.535334 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:29:52.554491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:52.554773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:52.558535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a810d0>]}
[0m11:29:52.565753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b4ac0>]}
[0m11:29:52.566113 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:29:52.566381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b4eb0>]}
[0m11:29:52.567403 [info ] [MainThread]: 
[0m11:29:52.567871 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:29:52.568550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:29:52.575009 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:29:52.575248 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:29:52.575429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:53.988428 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m11:29:53.993270 [debug] [ThreadPool]: On list_postgres: Close
[0m11:29:53.996751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_nandrianova)
[0m11:29:54.005633 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:29:54.006086 [debug] [ThreadPool]: On list_postgres_public_nandrianova: BEGIN
[0m11:29:54.006438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:55.317492 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m11:29:55.318504 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:29:55.319192 [debug] [ThreadPool]: On list_postgres_public_nandrianova: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres_public_nandrianova"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_nandrianova'
  
[0m11:29:55.464716 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:29:55.467757 [debug] [ThreadPool]: On list_postgres_public_nandrianova: ROLLBACK
[0m11:29:55.608232 [debug] [ThreadPool]: On list_postgres_public_nandrianova: Close
[0m11:29:55.618887 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:55.619501 [debug] [MainThread]: On master: BEGIN
[0m11:29:55.619914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:56.983277 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m11:29:56.983967 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:56.984514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:29:57.183895 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:29:57.187671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b529a0>]}
[0m11:29:57.188573 [debug] [MainThread]: On master: ROLLBACK
[0m11:29:57.383861 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:57.386019 [debug] [MainThread]: On master: BEGIN
[0m11:29:57.742728 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:29:57.743433 [debug] [MainThread]: On master: COMMIT
[0m11:29:57.743773 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:57.744078 [debug] [MainThread]: On master: COMMIT
[0m11:29:57.942280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:29:57.943025 [debug] [MainThread]: On master: Close
[0m11:29:57.944666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:57.945403 [info ] [MainThread]: 
[0m11:29:57.951754 [debug] [Thread-1  ]: Began running node model.Scentbird.deferred_revenue_report
[0m11:29:57.952630 [info ] [Thread-1  ]: 1 of 3 START sql view model public_nandrianova.deferred_revenue_report ......... [RUN]
[0m11:29:57.954257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_nandrianova, now model.Scentbird.deferred_revenue_report)
[0m11:29:57.954929 [debug] [Thread-1  ]: Began compiling node model.Scentbird.deferred_revenue_report
[0m11:29:57.964694 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.deferred_revenue_report"
[0m11:29:57.965806 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (compile): 11:29:57.955242 => 11:29:57.965527
[0m11:29:57.966215 [debug] [Thread-1  ]: Began executing node model.Scentbird.deferred_revenue_report
[0m11:29:57.998368 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.deferred_revenue_report"
[0m11:29:57.999342 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:29:57.999630 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: BEGIN
[0m11:29:57.999887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:29:59.702080 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m11:29:59.703119 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:29:59.703699 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */

  create view "postgres"."public_nandrianova"."deferred_revenue_report__dbt_tmp"
    
    
  as (
    with pre_t as (select date_trunc('month', created_at)::date as created_month
                    , date_trunc('month', shipped_at)::date as shipped_month
                    , amount
               from "postgres"."public_exercises"."orders")
select created_month as report_date
     , sum(amount)   as total_amount
from pre_t
where 1 = 1
  and created_month != shipped_month
group by report_date
  );
[0m11:29:59.902103 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:29:59.910010 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:29:59.910405 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
alter table "postgres"."public_nandrianova"."deferred_revenue_report" rename to "deferred_revenue_report__dbt_backup"
[0m11:30:00.143927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:00.152370 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:30:00.153094 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
alter table "postgres"."public_nandrianova"."deferred_revenue_report__dbt_tmp" rename to "deferred_revenue_report"
[0m11:30:00.342207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:00.364516 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: COMMIT
[0m11:30:00.365014 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:30:00.365401 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: COMMIT
[0m11:30:00.541144 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:30:00.546965 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."deferred_revenue_report__dbt_backup"
[0m11:30:00.552425 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:30:00.552844 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
drop view if exists "postgres"."public_nandrianova"."deferred_revenue_report__dbt_backup" cascade
[0m11:30:00.740721 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:30:00.742593 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (execute): 11:29:57.966516 => 11:30:00.742441
[0m11:30:00.742886 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: Close
[0m11:30:00.743538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b72cd0>]}
[0m11:30:00.743939 [info ] [Thread-1  ]: 1 of 3 OK created sql view model public_nandrianova.deferred_revenue_report .... [[32mCREATE VIEW[0m in 2.79s]
[0m11:30:00.744301 [debug] [Thread-1  ]: Finished running node model.Scentbird.deferred_revenue_report
[0m11:30:00.744634 [debug] [Thread-1  ]: Began running node model.Scentbird.marketing_conversion_report
[0m11:30:00.744934 [info ] [Thread-1  ]: 2 of 3 START sql view model public_nandrianova.marketing_conversion_report ..... [RUN]
[0m11:30:00.745433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.Scentbird.deferred_revenue_report, now model.Scentbird.marketing_conversion_report)
[0m11:30:00.745699 [debug] [Thread-1  ]: Began compiling node model.Scentbird.marketing_conversion_report
[0m11:30:00.748900 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.marketing_conversion_report"
[0m11:30:00.749602 [debug] [Thread-1  ]: Timing info for model.Scentbird.marketing_conversion_report (compile): 11:30:00.745845 => 11:30:00.749434
[0m11:30:00.750020 [debug] [Thread-1  ]: Began executing node model.Scentbird.marketing_conversion_report
[0m11:30:00.782473 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.marketing_conversion_report"
[0m11:30:00.783254 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:30:00.783527 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: BEGIN
[0m11:30:00.783802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:02.462365 [debug] [Thread-1  ]: SQL status: BEGIN in 2.0 seconds
[0m11:30:02.463325 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:30:02.464781 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.marketing_conversion_report"} */

  create view "postgres"."public_nandrianova"."marketing_conversion_report__dbt_tmp"
    
    
  as (
    WITH pre_t AS (SELECT ev.id          AS event_id
                    , ev.user_id     AS user_id
                    , ev.created_at  AS event_created_at
                    , ev.event_name  AS event_name
                    , ord.id         AS order_id
                    , ord.amount     AS order_amount
                    , ord.created_at AS order_created_at
               FROM "postgres"."public_exercises"."events" ev
                        LEFT JOIN "postgres"."public_exercises"."orders" ord
               ON ev.user_id = ord.user_id
                   AND (ord.created_at - ev.created_at) <= INTERVAL '24 hour'
               WHERE 1 = 1
                 AND event_name = 'AdvertisingCampaignSet')
SELECT event_name                                  AS campaign_name
     , DATE_TRUNC('month', event_created_at)::date AS report_date
     , SUM(order_amount)                           AS total_revenue
FROM pre_t
GROUP BY campaign_name, report_date
  );
[0m11:30:02.661776 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:30:02.675979 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:30:02.677096 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.marketing_conversion_report"} */
alter table "postgres"."public_nandrianova"."marketing_conversion_report__dbt_tmp" rename to "marketing_conversion_report"
[0m11:30:02.864074 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:02.874186 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: COMMIT
[0m11:30:02.875406 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:30:02.876285 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: COMMIT
[0m11:30:03.061096 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:30:03.071812 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."marketing_conversion_report__dbt_backup"
[0m11:30:03.074809 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:30:03.075698 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.marketing_conversion_report"} */
drop view if exists "postgres"."public_nandrianova"."marketing_conversion_report__dbt_backup" cascade
[0m11:30:03.260524 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:30:03.271762 [debug] [Thread-1  ]: Timing info for model.Scentbird.marketing_conversion_report (execute): 11:30:00.750282 => 11:30:03.270923
[0m11:30:03.273343 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: Close
[0m11:30:03.276785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b92250>]}
[0m11:30:03.278763 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public_nandrianova.marketing_conversion_report  [[32mCREATE VIEW[0m in 2.53s]
[0m11:30:03.280240 [debug] [Thread-1  ]: Finished running node model.Scentbird.marketing_conversion_report
[0m11:30:03.283202 [debug] [Thread-1  ]: Began running node model.Scentbird.revenue_report
[0m11:30:03.284982 [info ] [Thread-1  ]: 3 of 3 START sql view model public_nandrianova.revenue_report .................. [RUN]
[0m11:30:03.286550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.Scentbird.marketing_conversion_report, now model.Scentbird.revenue_report)
[0m11:30:03.287238 [debug] [Thread-1  ]: Began compiling node model.Scentbird.revenue_report
[0m11:30:03.293211 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.revenue_report"
[0m11:30:03.294896 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (compile): 11:30:03.287629 => 11:30:03.294505
[0m11:30:03.295528 [debug] [Thread-1  ]: Began executing node model.Scentbird.revenue_report
[0m11:30:03.302504 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.revenue_report"
[0m11:30:03.303716 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:30:03.304235 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: BEGIN
[0m11:30:03.304634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:30:04.791326 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m11:30:04.793815 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:30:04.795108 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */

  create view "postgres"."public_nandrianova"."revenue_report__dbt_tmp"
    
    
  as (
    select date_trunc('month', created_at)::date as report_date
     , sum(amount)                           as total_amount
from "postgres"."public_exercises"."orders"
group by report_date
  );
[0m11:30:04.945254 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:30:04.959154 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:30:04.960265 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
alter table "postgres"."public_nandrianova"."revenue_report" rename to "revenue_report__dbt_backup"
[0m11:30:05.098184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:05.116869 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:30:05.118281 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
alter table "postgres"."public_nandrianova"."revenue_report__dbt_tmp" rename to "revenue_report"
[0m11:30:05.256369 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:30:05.270038 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m11:30:05.271200 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:30:05.271900 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m11:30:05.410351 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:30:05.427489 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."revenue_report__dbt_backup"
[0m11:30:05.429529 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:30:05.430474 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
drop view if exists "postgres"."public_nandrianova"."revenue_report__dbt_backup" cascade
[0m11:30:05.576625 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:30:05.580132 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (execute): 11:30:03.295890 => 11:30:05.579788
[0m11:30:05.580630 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: Close
[0m11:30:05.581729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ea94647-b79b-472e-aa64-dbeb79dab534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b36190>]}
[0m11:30:05.582434 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public_nandrianova.revenue_report ............. [[32mCREATE VIEW[0m in 2.30s]
[0m11:30:05.582933 [debug] [Thread-1  ]: Finished running node model.Scentbird.revenue_report
[0m11:30:05.584583 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:05.584974 [debug] [MainThread]: On master: BEGIN
[0m11:30:05.585223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:06.853359 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m11:30:06.855388 [debug] [MainThread]: On master: COMMIT
[0m11:30:06.856534 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:06.857662 [debug] [MainThread]: On master: COMMIT
[0m11:30:06.998549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:30:07.001575 [debug] [MainThread]: On master: Close
[0m11:30:07.006727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:07.008096 [debug] [MainThread]: Connection 'model.Scentbird.revenue_report' was properly closed.
[0m11:30:07.010993 [info ] [MainThread]: 
[0m11:30:07.012060 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 14.44 seconds (14.44s).
[0m11:30:07.015023 [debug] [MainThread]: Command end result
[0m11:30:07.039285 [info ] [MainThread]: 
[0m11:30:07.040117 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:30:07.040555 [info ] [MainThread]: 
[0m11:30:07.041048 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:30:07.043561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.704131, "process_user_time": 1.795594, "process_kernel_time": 0.173102, "process_mem_max_rss": "121126912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:07.044243 [debug] [MainThread]: Command `dbt run` succeeded at 11:30:07.044078 after 14.70 seconds
[0m11:30:07.044785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f88400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bda6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c64e50>]}
[0m11:30:07.045521 [debug] [MainThread]: Flushing usage events
[0m11:32:12.039651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a53400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065291c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656e2b0>]}


============================== 11:32:12.042746 | e71fd6f5-ee43-499e-964e-f213ac4aae90 ==============================
[0m11:32:12.042746 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:32:12.043096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:32:12.155185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e71fd6f5-ee43-499e-964e-f213ac4aae90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065472e0>]}
[0m11:32:12.203142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e71fd6f5-ee43-499e-964e-f213ac4aae90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b2730>]}
[0m11:32:12.203733 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m11:32:12.213549 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:32:12.219769 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:32:12.220055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e71fd6f5-ee43-499e-964e-f213ac4aae90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b18a00>]}
[0m11:32:12.775698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e71fd6f5-ee43-499e-964e-f213ac4aae90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072470d0>]}
[0m11:32:12.782081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e71fd6f5-ee43-499e-964e-f213ac4aae90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b22640>]}
[0m11:32:12.782373 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:32:12.782803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e71fd6f5-ee43-499e-964e-f213ac4aae90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f4e80>]}
[0m11:32:12.783637 [info ] [MainThread]: 
[0m11:32:12.783881 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:32:12.788517 [info ] [MainThread]: Done.
[0m11:32:12.789532 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.78407073, "process_user_time": 1.842087, "process_kernel_time": 0.128604, "process_mem_max_rss": "112607232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:12.789889 [debug] [MainThread]: Command `dbt source freshness` succeeded at 11:32:12.789801 after 0.78 seconds
[0m11:32:12.790124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a53400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689a9a0>]}
[0m11:32:12.790353 [debug] [MainThread]: Flushing usage events
[0m11:32:17.616586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ad46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ec7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e06d0>]}


============================== 11:32:17.619144 | 900fc027-7bc2-41ee-a521-da260c75e58c ==============================
[0m11:32:17.619144 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:32:17.619464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:17.719085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a325b0>]}
[0m11:32:17.767161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104902cd0>]}
[0m11:32:17.767657 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m11:32:17.776854 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:32:17.795849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:17.796123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:17.800111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a70d0>]}
[0m11:32:17.807048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fddb20>]}
[0m11:32:17.807364 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:32:17.807633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fddf10>]}
[0m11:32:17.808584 [info ] [MainThread]: 
[0m11:32:17.809045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:32:17.809710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:32:17.815929 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:32:17.816146 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:32:17.816340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:19.237693 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m11:32:19.241721 [debug] [ThreadPool]: On list_postgres: Close
[0m11:32:19.245902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_nandrianova)
[0m11:32:19.254873 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:32:19.255376 [debug] [ThreadPool]: On list_postgres_public_nandrianova: BEGIN
[0m11:32:19.255812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:20.545389 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m11:32:20.546244 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:32:20.546859 [debug] [ThreadPool]: On list_postgres_public_nandrianova: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres_public_nandrianova"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_nandrianova'
  
[0m11:32:20.695445 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:32:20.698945 [debug] [ThreadPool]: On list_postgres_public_nandrianova: ROLLBACK
[0m11:32:20.846088 [debug] [ThreadPool]: On list_postgres_public_nandrianova: Close
[0m11:32:20.860901 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:20.861524 [debug] [MainThread]: On master: BEGIN
[0m11:32:20.861942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:22.165974 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m11:32:22.168208 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:22.169588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:32:22.315163 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m11:32:22.320026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdd460>]}
[0m11:32:22.321123 [debug] [MainThread]: On master: ROLLBACK
[0m11:32:22.465337 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:22.467400 [debug] [MainThread]: On master: BEGIN
[0m11:32:22.755438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:22.757457 [debug] [MainThread]: On master: COMMIT
[0m11:32:22.758305 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:22.759146 [debug] [MainThread]: On master: COMMIT
[0m11:32:22.904906 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:22.906568 [debug] [MainThread]: On master: Close
[0m11:32:22.908098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:32:22.908813 [info ] [MainThread]: 
[0m11:32:22.915358 [debug] [Thread-1  ]: Began running node model.Scentbird.deferred_revenue_report
[0m11:32:22.916143 [info ] [Thread-1  ]: 1 of 3 START sql <materialization_name> model public_nandrianova.deferred_revenue_report  [RUN]
[0m11:32:22.917038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_nandrianova, now model.Scentbird.deferred_revenue_report)
[0m11:32:22.917494 [debug] [Thread-1  ]: Began compiling node model.Scentbird.deferred_revenue_report
[0m11:32:22.927341 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.deferred_revenue_report"
[0m11:32:22.928731 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (compile): 11:32:22.917764 => 11:32:22.928455
[0m11:32:22.929113 [debug] [Thread-1  ]: Began executing node model.Scentbird.deferred_revenue_report
[0m11:32:22.931227 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (execute): 11:32:22.929417 => 11:32:22.931024
[0m11:32:22.937793 [debug] [Thread-1  ]: Compilation Error in model deferred_revenue_report (models/deferred_revenue_report.sql)
  No materialization '<materialization_name>' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m11:32:22.938166 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184160>]}
[0m11:32:22.938647 [error] [Thread-1  ]: 1 of 3 ERROR creating sql <materialization_name> model public_nandrianova.deferred_revenue_report  [[31mERROR[0m in 0.02s]
[0m11:32:22.939117 [debug] [Thread-1  ]: Finished running node model.Scentbird.deferred_revenue_report
[0m11:32:22.939449 [debug] [Thread-1  ]: Began running node model.Scentbird.marketing_conversion_report
[0m11:32:22.939860 [info ] [Thread-1  ]: 2 of 3 START sql <materialization_name> model public_nandrianova.marketing_conversion_report  [RUN]
[0m11:32:22.940400 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.Scentbird.deferred_revenue_report, now model.Scentbird.marketing_conversion_report)
[0m11:32:22.940688 [debug] [Thread-1  ]: Began compiling node model.Scentbird.marketing_conversion_report
[0m11:32:22.943792 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.marketing_conversion_report"
[0m11:32:22.944387 [debug] [Thread-1  ]: Timing info for model.Scentbird.marketing_conversion_report (compile): 11:32:22.940917 => 11:32:22.944213
[0m11:32:22.944663 [debug] [Thread-1  ]: Began executing node model.Scentbird.marketing_conversion_report
[0m11:32:22.946121 [debug] [Thread-1  ]: Timing info for model.Scentbird.marketing_conversion_report (execute): 11:32:22.944823 => 11:32:22.945957
[0m11:32:22.946756 [debug] [Thread-1  ]: Compilation Error in model marketing_conversion_report (models/marketing_conversion_report.sql)
  No materialization '<materialization_name>' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m11:32:22.947035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184850>]}
[0m11:32:22.947440 [error] [Thread-1  ]: 2 of 3 ERROR creating sql <materialization_name> model public_nandrianova.marketing_conversion_report  [[31mERROR[0m in 0.01s]
[0m11:32:22.947875 [debug] [Thread-1  ]: Finished running node model.Scentbird.marketing_conversion_report
[0m11:32:22.948176 [debug] [Thread-1  ]: Began running node model.Scentbird.revenue_report
[0m11:32:22.948562 [info ] [Thread-1  ]: 3 of 3 START sql <materialization_name> model public_nandrianova.revenue_report  [RUN]
[0m11:32:22.949099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.Scentbird.marketing_conversion_report, now model.Scentbird.revenue_report)
[0m11:32:22.949385 [debug] [Thread-1  ]: Began compiling node model.Scentbird.revenue_report
[0m11:32:22.951794 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.revenue_report"
[0m11:32:22.952372 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (compile): 11:32:22.949546 => 11:32:22.952208
[0m11:32:22.952635 [debug] [Thread-1  ]: Began executing node model.Scentbird.revenue_report
[0m11:32:22.954072 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (execute): 11:32:22.952790 => 11:32:22.953923
[0m11:32:22.954690 [debug] [Thread-1  ]: Compilation Error in model revenue_report (models/revenue_report.sql)
  No materialization '<materialization_name>' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m11:32:22.954957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '900fc027-7bc2-41ee-a521-da260c75e58c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184f70>]}
[0m11:32:22.955331 [error] [Thread-1  ]: 3 of 3 ERROR creating sql <materialization_name> model public_nandrianova.revenue_report  [[31mERROR[0m in 0.01s]
[0m11:32:22.955690 [debug] [Thread-1  ]: Finished running node model.Scentbird.revenue_report
[0m11:32:22.956485 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:22.956695 [debug] [MainThread]: On master: BEGIN
[0m11:32:22.956881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:24.270128 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m11:32:24.271847 [debug] [MainThread]: On master: COMMIT
[0m11:32:24.272566 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:24.273113 [debug] [MainThread]: On master: COMMIT
[0m11:32:24.414506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:24.416316 [debug] [MainThread]: On master: Close
[0m11:32:24.419868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:24.420406 [debug] [MainThread]: Connection 'model.Scentbird.revenue_report' was properly closed.
[0m11:32:24.421025 [info ] [MainThread]: 
[0m11:32:24.421627 [info ] [MainThread]: Finished running 3 <materialization_name> models in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m11:32:24.423216 [debug] [MainThread]: Command end result
[0m11:32:24.436323 [info ] [MainThread]: 
[0m11:32:24.436836 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:32:24.437173 [info ] [MainThread]: 
[0m11:32:24.437483 [error] [MainThread]:   Compilation Error in model deferred_revenue_report (models/deferred_revenue_report.sql)
  No materialization '<materialization_name>' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m11:32:24.437788 [info ] [MainThread]: 
[0m11:32:24.438083 [error] [MainThread]:   Compilation Error in model marketing_conversion_report (models/marketing_conversion_report.sql)
  No materialization '<materialization_name>' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m11:32:24.438623 [info ] [MainThread]: 
[0m11:32:24.439003 [error] [MainThread]:   Compilation Error in model revenue_report (models/revenue_report.sql)
  No materialization '<materialization_name>' was found for adapter postgres! (searched types 'default' and 'postgres')
[0m11:32:24.439322 [info ] [MainThread]: 
[0m11:32:24.439673 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m11:32:24.441552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8580956, "process_user_time": 1.504178, "process_kernel_time": 0.147857, "process_mem_max_rss": "118898688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:24.442109 [debug] [MainThread]: Command `dbt run` failed at 11:32:24.441984 after 6.86 seconds
[0m11:32:24.442505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ad46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104943190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520d670>]}
[0m11:32:24.442923 [debug] [MainThread]: Flushing usage events
[0m11:33:16.448923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b83cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a16e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108afa30>]}


============================== 11:33:16.451316 | 8f789d8d-6bc9-4917-9856-fbaa9450d041 ==============================
[0m11:33:16.451316 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:33:16.451643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt', 'log_path': '/Users/natalaandrianova/PycharmProjects/Scentbird/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:33:16.551169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a16e20>]}
[0m11:33:16.598763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f68670>]}
[0m11:33:16.599295 [info ] [MainThread]: Registered adapter: postgres=1.7.9
[0m11:33:16.608287 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:33:16.627743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m11:33:16.628217 [debug] [MainThread]: Partial parsing: updated file: Scentbird://models/marketing_conversion_report.sql
[0m11:33:16.628452 [debug] [MainThread]: Partial parsing: updated file: Scentbird://models/revenue_report.sql
[0m11:33:16.628672 [debug] [MainThread]: Partial parsing: updated file: Scentbird://models/deferred_revenue_report.sql
[0m11:33:16.707841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11169ff40>]}
[0m11:33:16.714573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b4ac0>]}
[0m11:33:16.714882 [info ] [MainThread]: Found 3 models, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:33:16.715141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b4eb0>]}
[0m11:33:16.716132 [info ] [MainThread]: 
[0m11:33:16.716607 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:33:16.717256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:33:16.723919 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:33:16.724181 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:33:16.724367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:18.133846 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m11:33:18.138894 [debug] [ThreadPool]: On list_postgres: Close
[0m11:33:18.142444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_public_nandrianova)
[0m11:33:18.210863 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:33:18.211159 [debug] [ThreadPool]: On list_postgres_public_nandrianova: BEGIN
[0m11:33:18.211334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:19.524146 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m11:33:19.526124 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_nandrianova"
[0m11:33:19.527047 [debug] [ThreadPool]: On list_postgres_public_nandrianova: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "list_postgres_public_nandrianova"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_nandrianova'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_nandrianova'
  
[0m11:33:19.674221 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:33:19.679313 [debug] [ThreadPool]: On list_postgres_public_nandrianova: ROLLBACK
[0m11:33:19.825241 [debug] [ThreadPool]: On list_postgres_public_nandrianova: Close
[0m11:33:19.836721 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:19.837365 [debug] [MainThread]: On master: BEGIN
[0m11:33:19.837784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:21.155903 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m11:33:21.158557 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:21.159711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:33:21.308562 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m11:33:21.312649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111784df0>]}
[0m11:33:21.313344 [debug] [MainThread]: On master: ROLLBACK
[0m11:33:21.454688 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:21.456429 [debug] [MainThread]: On master: BEGIN
[0m11:33:21.745405 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:33:21.746511 [debug] [MainThread]: On master: COMMIT
[0m11:33:21.747554 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:21.748151 [debug] [MainThread]: On master: COMMIT
[0m11:33:21.891701 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:33:21.893974 [debug] [MainThread]: On master: Close
[0m11:33:21.895972 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:21.896616 [info ] [MainThread]: 
[0m11:33:21.900547 [debug] [Thread-1  ]: Began running node model.Scentbird.deferred_revenue_report
[0m11:33:21.901393 [info ] [Thread-1  ]: 1 of 3 START sql table model public_nandrianova.deferred_revenue_report ........ [RUN]
[0m11:33:21.902425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_postgres_public_nandrianova, now model.Scentbird.deferred_revenue_report)
[0m11:33:21.902947 [debug] [Thread-1  ]: Began compiling node model.Scentbird.deferred_revenue_report
[0m11:33:21.913730 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.deferred_revenue_report"
[0m11:33:21.914854 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (compile): 11:33:21.903251 => 11:33:21.914595
[0m11:33:21.915252 [debug] [Thread-1  ]: Began executing node model.Scentbird.deferred_revenue_report
[0m11:33:21.949072 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.deferred_revenue_report"
[0m11:33:21.949730 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:33:21.949983 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: BEGIN
[0m11:33:21.950213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:23.256051 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m11:33:23.257205 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:33:23.257804 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */

  
    

  create  table "postgres"."public_nandrianova"."deferred_revenue_report__dbt_tmp"
  
  
    as
  
  (
    
with pre_t as (select date_trunc('month', created_at)::date as created_month
                    , date_trunc('month', shipped_at)::date as shipped_month
                    , amount
               from "postgres"."public_exercises"."orders")
select created_month as report_date
     , sum(amount)   as total_amount
from pre_t
where 1 = 1
  and created_month != shipped_month
group by report_date
  );
  
[0m11:33:23.425790 [debug] [Thread-1  ]: SQL status: SELECT 25 in 0.0 seconds
[0m11:33:23.440133 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:33:23.440821 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
alter table "postgres"."public_nandrianova"."deferred_revenue_report" rename to "deferred_revenue_report__dbt_backup"
[0m11:33:23.585921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:33:23.595899 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:33:23.596557 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
alter table "postgres"."public_nandrianova"."deferred_revenue_report__dbt_tmp" rename to "deferred_revenue_report"
[0m11:33:23.746757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:33:23.774726 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: COMMIT
[0m11:33:23.775192 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:33:23.775514 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: COMMIT
[0m11:33:23.917015 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:33:23.927056 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."deferred_revenue_report__dbt_backup"
[0m11:33:23.931805 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.deferred_revenue_report"
[0m11:33:23.932173 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.deferred_revenue_report"} */
drop view if exists "postgres"."public_nandrianova"."deferred_revenue_report__dbt_backup" cascade
[0m11:33:24.076398 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:33:24.081659 [debug] [Thread-1  ]: Timing info for model.Scentbird.deferred_revenue_report (execute): 11:33:21.915571 => 11:33:24.081249
[0m11:33:24.082426 [debug] [Thread-1  ]: On model.Scentbird.deferred_revenue_report: Close
[0m11:33:24.084077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116fcdc0>]}
[0m11:33:24.085160 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public_nandrianova.deferred_revenue_report ... [[32mSELECT 25[0m in 2.18s]
[0m11:33:24.085975 [debug] [Thread-1  ]: Finished running node model.Scentbird.deferred_revenue_report
[0m11:33:24.086588 [debug] [Thread-1  ]: Began running node model.Scentbird.marketing_conversion_report
[0m11:33:24.087352 [info ] [Thread-1  ]: 2 of 3 START sql table model public_nandrianova.marketing_conversion_report .... [RUN]
[0m11:33:24.088335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.Scentbird.deferred_revenue_report, now model.Scentbird.marketing_conversion_report)
[0m11:33:24.088856 [debug] [Thread-1  ]: Began compiling node model.Scentbird.marketing_conversion_report
[0m11:33:24.094101 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.marketing_conversion_report"
[0m11:33:24.095432 [debug] [Thread-1  ]: Timing info for model.Scentbird.marketing_conversion_report (compile): 11:33:24.089156 => 11:33:24.095169
[0m11:33:24.095873 [debug] [Thread-1  ]: Began executing node model.Scentbird.marketing_conversion_report
[0m11:33:24.100875 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.marketing_conversion_report"
[0m11:33:24.101596 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:33:24.101955 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: BEGIN
[0m11:33:24.102302 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:25.397253 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m11:33:25.399495 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:33:25.400367 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.marketing_conversion_report"} */

  
    

  create  table "postgres"."public_nandrianova"."marketing_conversion_report__dbt_tmp"
  
  
    as
  
  (
    

WITH pre_t AS (SELECT ev.id          AS event_id
                    , ev.user_id     AS user_id
                    , ev.created_at  AS event_created_at
                    , ev.event_name  AS event_name
                    , ord.id         AS order_id
                    , ord.amount     AS order_amount
                    , ord.created_at AS order_created_at
               FROM "postgres"."public_exercises"."events" ev
                        LEFT JOIN "postgres"."public_exercises"."orders" ord
               ON ev.user_id = ord.user_id
                   AND (ord.created_at - ev.created_at) <= INTERVAL '24 hour'
               WHERE 1 = 1
                 AND event_name = 'AdvertisingCampaignSet')
SELECT event_name                                  AS campaign_name
     , DATE_TRUNC('month', event_created_at)::date AS report_date
     , SUM(order_amount)                           AS total_revenue
FROM pre_t
GROUP BY campaign_name, report_date
  );
  
[0m11:33:25.567194 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0.0 seconds
[0m11:33:25.575530 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:33:25.576316 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.marketing_conversion_report"} */
alter table "postgres"."public_nandrianova"."marketing_conversion_report" rename to "marketing_conversion_report__dbt_backup"
[0m11:33:25.726750 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:33:25.736219 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:33:25.736926 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.marketing_conversion_report"} */
alter table "postgres"."public_nandrianova"."marketing_conversion_report__dbt_tmp" rename to "marketing_conversion_report"
[0m11:33:25.877053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:33:25.883832 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: COMMIT
[0m11:33:25.884732 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:33:25.885369 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: COMMIT
[0m11:33:26.038586 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:33:26.047802 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."marketing_conversion_report__dbt_backup"
[0m11:33:26.049127 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.marketing_conversion_report"
[0m11:33:26.049673 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.marketing_conversion_report"} */
drop view if exists "postgres"."public_nandrianova"."marketing_conversion_report__dbt_backup" cascade
[0m11:33:26.197462 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:33:26.201982 [debug] [Thread-1  ]: Timing info for model.Scentbird.marketing_conversion_report (execute): 11:33:24.096128 => 11:33:26.201527
[0m11:33:26.202803 [debug] [Thread-1  ]: On model.Scentbird.marketing_conversion_report: Close
[0m11:33:26.204478 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a4bf70>]}
[0m11:33:26.205540 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public_nandrianova.marketing_conversion_report  [[32mSELECT 4[0m in 2.12s]
[0m11:33:26.206358 [debug] [Thread-1  ]: Finished running node model.Scentbird.marketing_conversion_report
[0m11:33:26.206942 [debug] [Thread-1  ]: Began running node model.Scentbird.revenue_report
[0m11:33:26.207681 [info ] [Thread-1  ]: 3 of 3 START sql table model public_nandrianova.revenue_report ................. [RUN]
[0m11:33:26.208716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.Scentbird.marketing_conversion_report, now model.Scentbird.revenue_report)
[0m11:33:26.209250 [debug] [Thread-1  ]: Began compiling node model.Scentbird.revenue_report
[0m11:33:26.214198 [debug] [Thread-1  ]: Writing injected SQL for node "model.Scentbird.revenue_report"
[0m11:33:26.215459 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (compile): 11:33:26.209555 => 11:33:26.215185
[0m11:33:26.215938 [debug] [Thread-1  ]: Began executing node model.Scentbird.revenue_report
[0m11:33:26.220889 [debug] [Thread-1  ]: Writing runtime sql for node "model.Scentbird.revenue_report"
[0m11:33:26.221636 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:33:26.221998 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: BEGIN
[0m11:33:26.222328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:27.537452 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m11:33:27.539334 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:33:27.540423 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */

  
    

  create  table "postgres"."public_nandrianova"."revenue_report__dbt_tmp"
  
  
    as
  
  (
    

select date_trunc('month', created_at)::date as report_date
     , sum(amount)                           as total_amount
from "postgres"."public_exercises"."orders"
group by report_date
  );
  
[0m11:33:27.697835 [debug] [Thread-1  ]: SQL status: SELECT 26 in 0.0 seconds
[0m11:33:27.705468 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:33:27.706106 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
alter table "postgres"."public_nandrianova"."revenue_report" rename to "revenue_report__dbt_backup"
[0m11:33:27.857619 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:33:27.866528 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:33:27.867164 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
alter table "postgres"."public_nandrianova"."revenue_report__dbt_tmp" rename to "revenue_report"
[0m11:33:28.016864 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:33:28.023427 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m11:33:28.024176 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:33:28.024757 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: COMMIT
[0m11:33:28.166633 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:33:28.174166 [debug] [Thread-1  ]: Applying DROP to: "postgres"."public_nandrianova"."revenue_report__dbt_backup"
[0m11:33:28.175719 [debug] [Thread-1  ]: Using postgres connection "model.Scentbird.revenue_report"
[0m11:33:28.176347 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "Scentbird_default", "target_name": "dev", "node_id": "model.Scentbird.revenue_report"} */
drop view if exists "postgres"."public_nandrianova"."revenue_report__dbt_backup" cascade
[0m11:33:28.328021 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:33:28.332000 [debug] [Thread-1  ]: Timing info for model.Scentbird.revenue_report (execute): 11:33:26.216211 => 11:33:28.331558
[0m11:33:28.332767 [debug] [Thread-1  ]: On model.Scentbird.revenue_report: Close
[0m11:33:28.334364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f789d8d-6bc9-4917-9856-fbaa9450d041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1f880>]}
[0m11:33:28.335401 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public_nandrianova.revenue_report ............ [[32mSELECT 26[0m in 2.13s]
[0m11:33:28.336198 [debug] [Thread-1  ]: Finished running node model.Scentbird.revenue_report
[0m11:33:28.338141 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:28.338581 [debug] [MainThread]: On master: BEGIN
[0m11:33:28.338960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:29.907455 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m11:33:29.909565 [debug] [MainThread]: On master: COMMIT
[0m11:33:29.910325 [debug] [MainThread]: Using postgres connection "master"
[0m11:33:29.911166 [debug] [MainThread]: On master: COMMIT
[0m11:33:30.106623 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:33:30.109002 [debug] [MainThread]: On master: Close
[0m11:33:30.111750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:30.112466 [debug] [MainThread]: Connection 'model.Scentbird.revenue_report' was properly closed.
[0m11:33:30.113142 [info ] [MainThread]: 
[0m11:33:30.113754 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.40 seconds (13.40s).
[0m11:33:30.115283 [debug] [MainThread]: Command end result
[0m11:33:30.127620 [info ] [MainThread]: 
[0m11:33:30.128094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:30.128468 [info ] [MainThread]: 
[0m11:33:30.128819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:33:30.130385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.716663, "process_user_time": 1.898922, "process_kernel_time": 0.168083, "process_mem_max_rss": "123863040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:33:30.130836 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:30.130724 after 13.72 seconds
[0m11:33:30.131181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b83cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e1d220>]}
[0m11:33:30.131565 [debug] [MainThread]: Flushing usage events
